<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>
      Multi-Section Code Carousel with Active Section and
      Hash Routing
    </title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <link href="./slides.css" rel="stylesheet" />
  </head>
  <body>
    <aside>
      <nav>
        <button
          onclick="toggleNav(); document.exitFullscreen()"
        >
          Exit ↙️
        </button>
        <button
          onclick="toggleNav(); document.documentElement.requestFullscreen()"
        >
          Fullscreen ↗️
        </button>
        <ul></ul>
      </nav>
    </aside>
    <main>
      <article>
<h2><a href="#passkeys-are-kinda-great" aria-hidden="true" class="anchor" id="passkeys-are-kinda-great"></a>Passkeys are Kinda Great</h2>
<center><img src="https://github.com/user-attachments/assets/a5f95f86-2c64-4a72-bd81-01e68cfda991" style="width: 60cqw;" /></center>
<hr />
<h2><a href="#aj-oneal" aria-hidden="true" class="anchor" id="aj-oneal"></a>AJ ONeal</h2>
<p><a href="https://twitter.com/@_beyondcode">@_beyondcode</a> <br>
<a href="https://twitch.tv/coolaj86">twitch.tv/coolaj86</a> <br>
<a href="https://github.com/therootcompany/">github.com/therootcompany</a></p>
<br>
<p>Deep-Learner</p>
<p>Dangerous Wrong Thinker</p>
<hr />
<h1><a href="#gun-for-hire" aria-hidden="true" class="anchor" id="gun-for-hire"></a>Gun for Hire</h1>
<br>
<p>🐹 Go 📦 Node 🦎 Zig</p>
<p>🛜 Net 🔐 Sec 🐧 POSIX</p>
<br>
<p><a href="mailto:aj@therootcompany.com">aj@therootcompany.com</a></p>
<hr />
<h1><a href="#act-i-the-happy-path" aria-hidden="true" class="anchor" id="act-i-the-happy-path"></a>Act I: The Happy Path™</h1>
<center><img src="https://github.com/user-attachments/assets/a5f95f86-2c64-4a72-bd81-01e68cfda991" style="width: 60cqw;" /></center>
<hr />
<h1><a href="#brought-to-you-in-part-by" aria-hidden="true" class="anchor" id="brought-to-you-in-part-by"></a>Brought to you in part by</h1>
<ul>
<li>PaperOS: <a href="https://paperos.com">https://paperos.com</a></li>
<li>Kyle Simpson: <a href="https://x.com/@getifyX">https://x.com/@getifyX</a></li>
</ul>
<hr />
<h1><a href="#what-are-passkeys" aria-hidden="true" class="anchor" id="what-are-passkeys"></a>What are Passkeys?</h1>
<br>
<ol>
<li>A WebAuthn subset that's implemented* and works. <br />
(WebAuthn rebranded) <br> <br></li>
<li>The Password Manager, Reloaded™. <br />
(High-entropy, push-button)</li>
</ol>
<hr />
<h1><a href="#platform-support" aria-hidden="true" class="anchor" id="platform-support"></a>Platform Support</h1>
<br>
<ul>
<li><a href="https://caniuse.com/webauthn">Baseline™</a> Browser Support
<ul>
<li>Brave, Chrome, Edge, Firefox, Safari,</li>
<li>Android Browser, UC Browser, WebViews <br><br></li>
</ul>
</li>
<li>Universal OS / Cloud Support
<ul>
<li>Android, Chrome OS, iOS, Linux, macOS, Windows</li>
<li>iCloud, Google Sync, Microsoft... <em>thingy</em> (?)</li>
</ul>
</li>
</ul>
<hr />
<h1><a href="#product-support" aria-hidden="true" class="anchor" id="product-support"></a>Product Support</h1>
<ul>
<li>Android <em>thingy</em>
<a href="https://www.reddit.com/r/UXDesign/comments/10ruff4/comment/j6yiob5/">(?)</a></li>
<li>Face ID</li>
<li>Touch ID</li>
<li>YubiKey</li>
<li>Windows Hello</li>
</ul>
<hr />
<h2><a href="#too-new-too-fancy" aria-hidden="true" class="anchor" id="too-new-too-fancy"></a>Too New, Too Fancy?</h2>
<p><kbd><img src="https://github.com/user-attachments/assets/f51e3652-5cd9-4b9b-86d4-8d7186100e1d" style="width: 60cqw;"></kbd></p>
<hr />
<br>
<br>
<br>
<br>
<center>(true progressive enhancement)</center>
<hr />
<br>
<h1><a href="#demo" aria-hidden="true" class="anchor" id="demo"></a>Demo</h1>
<br>
<p><a href="https://passkeys.js.org">https://passkeys.js.org</a></p>
<hr />
<h1><a href="#the-magic-three-modes" aria-hidden="true" class="anchor" id="the-magic-three-modes"></a>The Magic™ (Three Modes)</h1>
<ol>
<li>Register (<code>webauthn.create</code>)
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#bf616a;">autofillCtrl</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">abort</span><span style="color:#c0c5ce;">();
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">credRegistration </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">await </span><span style="color:#c0c5ce;">navigator.credentials.</span><span style="color:#8fa1b3;">create</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">registrationOpts</span><span style="color:#c0c5ce;">);
</span></code></pre>
</li>
<li>Login (<code>webauthn.get</code>)
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#bf616a;">autofillCtrl</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">abort</span><span style="color:#c0c5ce;">();
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">credAttestation </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">await </span><span style="color:#c0c5ce;">navigator.credentials.</span><span style="color:#8fa1b3;">get</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">loginOpts</span><span style="color:#c0c5ce;">);
</span></code></pre>
</li>
<li>Autofill (<code>webauthn.get</code>, <code>mediation = &quot;conditional&quot;</code>)
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">autofillCtrl </span><span style="color:#c0c5ce;">= new </span><span style="color:#bf616a;">AbortController</span><span style="color:#c0c5ce;">();
</span><span style="color:#c0c5ce;">void navigator.credentials.</span><span style="color:#8fa1b3;">get</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">autofillOpts</span><span style="color:#c0c5ce;">).</span><span style="color:#8fa1b3;">then</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">onAutofill</span><span style="color:#c0c5ce;">);
</span></code></pre>
</li>
</ol>
<hr />
<h1><a href="#registration" aria-hidden="true" class="anchor" id="registration"></a>Registration</h1>
<ol>
<li>🌎 Generate Challenge</li>
<li>👨‍💻 Register Credential (<code>webauthn.create</code>)</li>
<li>🌎 Store Credential (one-to-many)</li>
</ol>
<hr />
<h1><a href="#authentication" aria-hidden="true" class="anchor" id="authentication"></a>Authentication</h1>
<ol>
<li>🌎 Generate Challenge</li>
<li>🌎 Get Credential IDs (i.e. by email)</li>
<li>👨‍💻 Authenticate Credential (<code>webauthn.get</code>)</li>
<li>🌎 Verify Message &amp; Signature</li>
<li>🌎 (optional) Update Counter</li>
</ol>
<hr />
<br>
<br>
<br>
<center><strong>Can you use Passkeys without a Library?</strong></center>
<hr />
<br>
<br>
<h1><a href="#no" aria-hidden="true" class="anchor" id="no"></a>No.</h1>
<p><small>(well, maybe)</small></p>
<hr />
<h2><a href="#closer-to-the-metal" aria-hidden="true" class="anchor" id="closer-to-the-metal"></a><em>Closer</em> to the Metal</h2>
<p>Maybe you're better off learning than off-loading.</p>
<hr />
<blockquote>
<p>Flat is better than nested. <br />
- Zen of Python</p>
</blockquote>
<blockquote>
<p>A little copying is better than a little dependency. <br />
- Go Proverbs</p>
</blockquote>
<blockquote>
<p>Favor reading code over writing code. <br />
- Zen of Zig</p>
</blockquote>
<hr />
<h2><a href="#-but-not-the-metal" aria-hidden="true" class="anchor" id="-but-not-the-metal"></a>... but not <em>the Metal</em></h2>
<p>Use abstractions to avoid confusion or <em>intense</em> tedium.</p>
<hr />
<br>
<br>
<br>
<br>
<center>(some assembly required, and... <em>nuance</em>)</center>
<hr />
<h1><a href="#auth-vocabulary" aria-hidden="true" class="anchor" id="auth-vocabulary"></a>Auth Vocabulary</h1>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Authc</td>
<td>Password, Magic Link,<br> Passkey, OTP,<br> &quot;Sign in with ...&quot;, etc</td>
</tr>
<tr>
<td>Authn</td>
<td>authentication <br>(who has access)</td>
</tr>
<tr>
<td>Authz</td>
<td>authorization <br>(what can be accessed)</td>
</tr>
</tbody>
</table>
<hr />
<h1><a href="#registration-1-of-3-challenge-vocabulary" aria-hidden="true" class="anchor" id="registration-1-of-3-challenge-vocabulary"></a>Registration 1 of 3: Challenge Vocabulary</h1>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Registration</td>
<td>Add a Passkey to Profile (new or updated)</td>
</tr>
<tr>
<td>Challenge</td>
<td>a server-side nonce</td>
</tr>
<tr>
<td>Nonce</td>
<td>arbitrary single-use data, such as a salt</td>
</tr>
<tr>
<td>Salt</td>
<td>random bytes, to make a hash unpredictable</td>
</tr>
<tr>
<td>Base64</td>
<td>-</td>
</tr>
<tr>
<td>URL Base64</td>
<td>Base64 but ( <code>+</code> <code>/</code> <code>=</code> ) ➡️ ( <code>-</code> <code>_</code> ␡ )</td>
</tr>
</tbody>
</table>
<hr />
<h4><a href="#registration-1-of-3--challenge" aria-hidden="true" class="anchor" id="registration-1-of-3--challenge"></a>Registration 1 of 3: 🌎 Challenge</h4>
<p><carousel data-line-start="1" data-slides="1-3 | 5 | 7-9"></carousel></p>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">challengeLen </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">64</span><span style="color:#c0c5ce;">;
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">challengeBytes </span><span style="color:#c0c5ce;">= new </span><span style="color:#bf616a;">Uint8Array</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">challengeLen</span><span style="color:#c0c5ce;">);
</span><span style="color:#bf616a;">globalThis</span><span style="color:#c0c5ce;">.crypto.</span><span style="color:#8fa1b3;">randomValues</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">challengeBytes</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">challenge </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">challengeBytes</span><span style="color:#c0c5ce;">, </span><span style="color:#ebcb8b;">Bytes</span><span style="color:#c0c5ce;">.URL_BASE64);
</span><span style="color:#c0c5ce;">
</span><span style="color:#ebcb8b;">DB</span><span style="color:#c0c5ce;">.Nonces.</span><span style="color:#8fa1b3;">set</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">challenge</span><span style="color:#c0c5ce;">, {
</span><span style="color:#c0c5ce;">	</span><span style="color:#65737e;">/* ... */
</span><span style="color:#c0c5ce;">});
</span></code></pre>
<hr />
<h1><a href="#registration-2-of-3-credential-vocabulary" aria-hidden="true" class="anchor" id="registration-2-of-3-credential-vocabulary"></a>Registration 2 of 3: Credential Vocabulary</h1>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Authenticator</td>
<td>Authenticator, the Device or Platform</td>
</tr>
<tr>
<td>Platform</td>
<td>the browser, OS, plugin, or service</td>
</tr>
<tr>
<td>Credential</td>
<td>Public Key (<code>P-256</code> or <code>ed25519</code>)</td>
</tr>
<tr>
<td>Credential ID</td>
<td>Authenticator's Pairwise ID</td>
</tr>
<tr>
<td>Pairwise</td>
<td>Tied to two (or more) things</td>
</tr>
<tr>
<td>Relying Party</td>
<td>domain name (the OG origin)</td>
</tr>
<tr>
<td>Attestation</td>
<td>details about the passkey device or service</td>
</tr>
</tbody>
</table>
<p>* <small>note: <em>Passkey</em> isn't on the list</small></p>
<hr />
<h4><a href="#registration-2-of-3--credential" aria-hidden="true" class="anchor" id="registration-2-of-3--credential"></a>Registration 2 of 3: 👨‍💻 Credential</h4>
<p><carousel data-line-start="1" data-slides="1-4 | 2 | 6-7 | 9-10 | 12-14 | 16-18"></carousel></p>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">relyingParty </span><span style="color:#c0c5ce;">= {
</span><span style="color:#c0c5ce;">	id: </span><span style="color:#bf616a;">location</span><span style="color:#c0c5ce;">.hostname, </span><span style="color:#65737e;">// cookie rules
</span><span style="color:#c0c5ce;">	name: &quot;</span><span style="color:#a3be8c;">My Brand</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">};
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">displayName </span><span style="color:#c0c5ce;">= &quot;</span><span style="color:#a3be8c;">...</span><span style="color:#c0c5ce;">&quot;;
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">email </span><span style="color:#c0c5ce;">= &quot;</span><span style="color:#a3be8c;">...</span><span style="color:#c0c5ce;">&quot;;
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">challenge </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">await App</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">getChallengeFor</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">email</span><span style="color:#c0c5ce;">);
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">credentialIds </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">await App</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">getCredIdsFor</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">email</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">userSecretLen </span><span style="color:#c0c5ce;">= </span><span style="color:#d08770;">64</span><span style="color:#c0c5ce;">;
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">userSecretBytes </span><span style="color:#c0c5ce;">= new </span><span style="color:#bf616a;">Uint8Array</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">userSecretLen</span><span style="color:#c0c5ce;">);
</span><span style="color:#bf616a;">globalThis</span><span style="color:#c0c5ce;">.crypto.</span><span style="color:#8fa1b3;">randomValues</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">userSecretBytes</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">(!</span><span style="color:#bf616a;">autofillCtrl</span><span style="color:#c0c5ce;">) {
</span><span style="color:#c0c5ce;">	</span><span style="color:#bf616a;">autofillCtrl </span><span style="color:#c0c5ce;">= new </span><span style="color:#bf616a;">AbortController</span><span style="color:#c0c5ce;">();
</span><span style="color:#c0c5ce;">}
</span></code></pre>
<hr />
<p><carousel data-line-start="1" data-slides="1,23 | 1,2-4,22-23 | 5-9 | 10 | 11 | 12-14 | 15 | 16 | 17-21 | 20"></carousel></p>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">registrationOpts </span><span style="color:#c0c5ce;">= {
</span><span style="color:#c0c5ce;">	mediation: &quot;</span><span style="color:#a3be8c;">optional</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#65737e;">// on button click
</span><span style="color:#c0c5ce;">	signal: </span><span style="color:#bf616a;">autofillCtrl</span><span style="color:#c0c5ce;">.signal,
</span><span style="color:#c0c5ce;">	publicKey: {
</span><span style="color:#c0c5ce;">		attestation: &quot;</span><span style="color:#a3be8c;">direct</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">		authenticatorSelection: {
</span><span style="color:#c0c5ce;">			residentKey: &quot;</span><span style="color:#a3be8c;">required</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">			userVerification: &quot;</span><span style="color:#a3be8c;">preferred</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">		},
</span><span style="color:#c0c5ce;">		challenge: </span><span style="color:#bf616a;">challenge</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">		excludeCredentials: </span><span style="color:#bf616a;">credentialIds</span><span style="color:#c0c5ce;">, </span><span style="color:#65737e;">// IMPORTANT (authcs)
</span><span style="color:#c0c5ce;">		pubKeyCredParams: [
</span><span style="color:#c0c5ce;">			{ type: &quot;</span><span style="color:#a3be8c;">public-key</span><span style="color:#c0c5ce;">&quot;, alg: -</span><span style="color:#d08770;">7 </span><span style="color:#c0c5ce;">}, </span><span style="color:#65737e;">// ECDSA P-256
</span><span style="color:#c0c5ce;">		],
</span><span style="color:#c0c5ce;">		rp: </span><span style="color:#bf616a;">relyingParty</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">		timeout: </span><span style="color:#d08770;">180 </span><span style="color:#c0c5ce;">* </span><span style="color:#d08770;">1000</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">		user: {
</span><span style="color:#c0c5ce;">			name: </span><span style="color:#bf616a;">email</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">			displayName: </span><span style="color:#bf616a;">displayName</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">			id: </span><span style="color:#bf616a;">userSecretBytes</span><span style="color:#c0c5ce;">, </span><span style="color:#65737e;">// NOT an ID
</span><span style="color:#c0c5ce;">		},
</span><span style="color:#c0c5ce;">	},
</span><span style="color:#c0c5ce;">};
</span></code></pre>
<hr />
<h4><a href="#registration-2-of-3--credential-1" aria-hidden="true" class="anchor" id="registration-2-of-3--credential-1"></a>Registration 2 of 3: 👨‍💻 Credential</h4>
<p><carousel data-line-start="1" data-slides="1 | 2 | 4"></carousel></p>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#bf616a;">autofillCtrl</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">abort</span><span style="color:#c0c5ce;">();
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">credential </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">await </span><span style="color:#c0c5ce;">navigator.credentials.</span><span style="color:#8fa1b3;">create</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">registrationOpts</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">console.</span><span style="color:#96b5b4;">log</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">credential</span><span style="color:#c0c5ce;">); </span><span style="color:#65737e;">// 😱
</span></code></pre>
<hr />
<p><carousel data-line-start="1" data-slides="1,23 | 2,12 | 3-4,14-15 | 7,16,17,19 | 8-9 | 2,11-13 | 3-4,14-15 | 16-17 | 7,16,17,19"></carousel></p>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">function </span><span style="color:#8fa1b3;">registrationToJSON</span><span style="color:#c0c5ce;">(cred) {
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">authenticatorData </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.response.</span><span style="color:#8fa1b3;">getAuthenticatorData</span><span style="color:#c0c5ce;">();
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">asn1Pubkey </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.response.</span><span style="color:#8fa1b3;">getPublicKey</span><span style="color:#c0c5ce;">(); </span><span style="color:#65737e;">// ArrayBuffer
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">coseKeyType </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.response.</span><span style="color:#8fa1b3;">getPublicKeyAlgorithm</span><span style="color:#c0c5ce;">(); </span><span style="color:#65737e;">// -7
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">jsonCred </span><span style="color:#c0c5ce;">= {
</span><span style="color:#c0c5ce;">		authenticatorAttachment: </span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.authenticatorAttachment, </span><span style="color:#65737e;">// &quot;platform&quot;
</span><span style="color:#c0c5ce;">		id: </span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.id,
</span><span style="color:#c0c5ce;">		rawId: </span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.rawId), </span><span style="color:#65737e;">// same as cred.id
</span><span style="color:#c0c5ce;">		response: {
</span><span style="color:#c0c5ce;">			attestationObject: </span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">attResp</span><span style="color:#c0c5ce;">.attestationObject),
</span><span style="color:#c0c5ce;">			authenticatorData: </span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">authenticatorData</span><span style="color:#c0c5ce;">),
</span><span style="color:#c0c5ce;">			clientDataJSON: </span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">attResp</span><span style="color:#c0c5ce;">.clientDataJSON),
</span><span style="color:#c0c5ce;">			publicKey: </span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">asn1Pubkey</span><span style="color:#c0c5ce;">),
</span><span style="color:#c0c5ce;">			publicKeyAlgorithm: </span><span style="color:#bf616a;">coseKeyType</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">			</span><span style="color:#65737e;">// [&quot;usb&quot;, &quot;ble&quot;, &quot;nfc&quot;, &quot;internal&quot;]
</span><span style="color:#c0c5ce;">			transports: </span><span style="color:#bf616a;">attResp</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">getTransports</span><span style="color:#c0c5ce;">(),
</span><span style="color:#c0c5ce;">		},
</span><span style="color:#c0c5ce;">		type: </span><span style="color:#bf616a;">cred</span><span style="color:#c0c5ce;">.type, </span><span style="color:#65737e;">// &quot;webauthn.create&quot;
</span><span style="color:#c0c5ce;">	};
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">jsonCred</span><span style="color:#c0c5ce;">;
</span><span style="color:#c0c5ce;">}
</span></code></pre>
<hr />
<br>
<br>
<br>
<center>
Fully Expanded Passkey Objects + JSDoc types
<br><small><a href="https://github.com/BeyondCodeBootcamp/passkeys/issues/6">https://github.com/BeyondCodeBootcamp/passkeys/issues/6</a></small></center>
<hr />
<h4><a href="#registration-3-of-3--store" aria-hidden="true" class="anchor" id="registration-3-of-3--store"></a>Registration 3 of 3: 🌎 Store</h4>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#65737e;">// 👨‍💻
</span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">Customer</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">register</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">emailToVerify</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">credential</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;">// or (authenticated)
</span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">Customer</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">addPasskey</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">verifiedEmail</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">credential</span><span style="color:#c0c5ce;">);
</span></code></pre>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#65737e;">// 🌎
</span><span style="color:#bf616a;">app</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">post</span><span style="color:#c0c5ce;">(`</span><span style="color:#a3be8c;">/api/customers</span><span style="color:#c0c5ce;">`, </span><span style="color:#b48ead;">async function </span><span style="color:#c0c5ce;">(req, res) {
</span><span style="color:#c0c5ce;">	</span><span style="color:#8fa1b3;">mustMostlyValidatePasskey</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">req</span><span style="color:#c0c5ce;">.body.passkey);
</span><span style="color:#c0c5ce;">	</span><span style="color:#ebcb8b;">DB</span><span style="color:#c0c5ce;">.Passkeys.</span><span style="color:#8fa1b3;">store</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">req</span><span style="color:#c0c5ce;">.customer.email, </span><span style="color:#bf616a;">req</span><span style="color:#c0c5ce;">.body.passkey);
</span><span style="color:#c0c5ce;">});
</span></code></pre>
<hr />
<h4><a href="#registration-3-of-3--store-1" aria-hidden="true" class="anchor" id="registration-3-of-3--store-1"></a>Registration 3 of 3: 🌎 Store</h4>
<pre lang="sql" style="background-color:#2b303b;"><code><span style="color:#b48ead;">CREATE TABLE</span><span style="color:#c0c5ce;"> &quot;</span><span style="color:#8fa1b3;">customer</span><span style="color:#c0c5ce;">&quot; (
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">id</span><span style="color:#c0c5ce;">&quot; UUID </span><span style="color:#b48ead;">PRIMARY KEY</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">username</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">100</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">DEFAULT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">given_name</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">100</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">DEFAULT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">family_name</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">100</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">DEFAULT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">zoneinfo</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">255</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">NOT NULL DEFAULT </span><span style="color:#c0c5ce;">&#39;&#39;,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">locale</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">255</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">NOT NULL DEFAULT </span><span style="color:#c0c5ce;">&#39;&#39;,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">created_at</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">TIMESTAMP NOT NULL DEFAULT </span><span style="color:#96b5b4;">CURRENT_TIMESTAMP</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">updated_at</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">TIMESTAMP NOT NULL DEFAULT </span><span style="color:#96b5b4;">CURRENT_TIMESTAMP</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">);
</span></code></pre>
<p>* <small>note the absence of 'email', 'phone', 'password'</small></p>
<hr />
<h4><a href="#registration-3-of-3--store-2" aria-hidden="true" class="anchor" id="registration-3-of-3--store-2"></a>Registration 3 of 3: 🌎 Store</h4>
<pre lang="sql" style="background-color:#2b303b;"><code><span style="color:#b48ead;">CREATE TABLE</span><span style="color:#c0c5ce;"> &quot;</span><span style="color:#8fa1b3;">authenticator</span><span style="color:#c0c5ce;">&quot; (
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">id</span><span style="color:#c0c5ce;">&quot; UUID </span><span style="color:#b48ead;">NOT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">customer_id</span><span style="color:#c0c5ce;">&quot; UUID </span><span style="color:#b48ead;">NOT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">priority</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">BIGINT NOT NULL CHECK</span><span style="color:#c0c5ce;"> (&quot;</span><span style="color:#a3be8c;">priority</span><span style="color:#c0c5ce;">&quot; &gt; </span><span style="color:#d08770;">0</span><span style="color:#c0c5ce;">),
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">type</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">16</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">NOT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">value</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">VARCHAR</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">255</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">NOT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">details</span><span style="color:#c0c5ce;">&quot; JSON </span><span style="color:#b48ead;">NOT NULL DEFAULT </span><span style="color:#c0c5ce;">&#39;</span><span style="color:#a3be8c;">{}</span><span style="color:#c0c5ce;">&#39;,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">verified_at</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">TIMESTAMP DEFAULT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">created_at</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">TIMESTAMP NOT NULL DEFAULT </span><span style="color:#96b5b4;">CURRENT_TIMESTAMP</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">updated_at</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">TIMESTAMP NOT NULL DEFAULT </span><span style="color:#96b5b4;">CURRENT_TIMESTAMP</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  &quot;</span><span style="color:#a3be8c;">revoked_at</span><span style="color:#c0c5ce;">&quot; </span><span style="color:#b48ead;">TIMESTAMP DEFAULT NULL</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">  </span><span style="color:#b48ead;">PRIMARY KEY</span><span style="color:#c0c5ce;"> (&quot;</span><span style="color:#a3be8c;">id</span><span style="color:#c0c5ce;">&quot;),
</span><span style="color:#c0c5ce;">  UNIQUE (&quot;</span><span style="color:#a3be8c;">id</span><span style="color:#c0c5ce;">&quot;, &quot;</span><span style="color:#a3be8c;">priority</span><span style="color:#c0c5ce;">&quot;),
</span><span style="color:#c0c5ce;">  UNIQUE (&quot;</span><span style="color:#a3be8c;">id</span><span style="color:#c0c5ce;">&quot;, &quot;</span><span style="color:#a3be8c;">type</span><span style="color:#c0c5ce;">&quot;, &quot;</span><span style="color:#a3be8c;">value</span><span style="color:#c0c5ce;">&quot;),
</span><span style="color:#c0c5ce;">  </span><span style="color:#b48ead;">CONSTRAINT </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">authenticator_customer_id_foreign</span><span style="color:#c0c5ce;">&quot;
</span><span style="color:#c0c5ce;">    </span><span style="color:#b48ead;">FOREIGN KEY</span><span style="color:#c0c5ce;"> (&quot;</span><span style="color:#a3be8c;">customer_id</span><span style="color:#c0c5ce;">&quot;) </span><span style="color:#b48ead;">REFERENCES </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">customer</span><span style="color:#c0c5ce;">&quot; (&quot;</span><span style="color:#a3be8c;">id</span><span style="color:#c0c5ce;">&quot;)
</span><span style="color:#c0c5ce;">);
</span></code></pre>
<hr />
<h4><a href="#registration-2-of-3--credential-2" aria-hidden="true" class="anchor" id="registration-2-of-3--credential-2"></a>Registration 2 of 3: 👨‍💻 Credential</h4>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON</td>
<td>-</td>
</tr>
<tr>
<td>Private Key</td>
<td><code>x</code> in <code>f(x) =&gt; y</code>, random bytes</td>
</tr>
<tr>
<td>Public Key</td>
<td><code>y</code> in <code>f(x) =&gt; y</code>, the result of the random bytes</td>
</tr>
<tr>
<td>Hash</td>
<td>lossy matrix math (tables) on a sequence of bytes</td>
</tr>
<tr>
<td>Signature</td>
<td>key + salt + matrix math + curve (alt public key)</td>
</tr>
</tbody>
</table>
<hr />
<h2><a href="#passkeys-vocabulary-cont-3" aria-hidden="true" class="anchor" id="passkeys-vocabulary-cont-3"></a>Passkeys Vocabulary (cont. 3)</h2>
<p>SKIP (we'll circle back)</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Assertion</td>
<td>signed server-side challenge (salt)</td>
</tr>
<tr>
<td>CBOR</td>
<td>binary JSON</td>
</tr>
<tr>
<td>COSE</td>
<td>binary JOSE (JWT)</td>
</tr>
<tr>
<td>AttToBeSigned</td>
<td>a bespoke hash of the bespoke data</td>
</tr>
<tr>
<td>ASN.1 / DER</td>
<td>binary XML</td>
</tr>
<tr>
<td>P1363</td>
<td>WebCrypto Signatures</td>
</tr>
<tr>
<td>(bespoke)</td>
<td>one-off, proprietary to WebAuthn</td>
</tr>
<tr>
<td><em>Foo</em>Credential</td>
<td>non-implemented WebAuthn stuff (we don't care)</td>
</tr>
</tbody>
</table>
<hr />
<h4><a href="#registration-challenge" aria-hidden="true" class="anchor" id="registration-challenge"></a>Registration: Challenge</h4>
<hr />
<h1><a href="#list-delete" aria-hidden="true" class="anchor" id="list-delete"></a>List, Delete?</h1>
<p>No.</p>
<ul>
<li><a href="https://github.com/BeyondCodeBootcamp/passkeys/issues/4">How to Manage Passkeys: OS, Browser, Key, etc</a></li>
<li><a href="chrome://settings/passkeys">chrome://settings/passkeys</a></li>
</ul>
<hr />
<h2><a href="#on-to-the-implementation" aria-hidden="true" class="anchor" id="on-to-the-implementation"></a>On to the Implementation</h2>
<hr />
<h2><a href="#platform--autofill-support" aria-hidden="true" class="anchor" id="platform--autofill-support"></a>Platform &amp; Autofill Support</h2>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">passkeyCredential </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">globalThis</span><span style="color:#c0c5ce;">.PublicKeyCredential;
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">hasPlatformSupport </span><span style="color:#c0c5ce;">=
</span><span style="color:#c0c5ce;">	</span><span style="color:#bf616a;">await passkeyCredential</span><span style="color:#c0c5ce;">?.</span><span style="color:#8fa1b3;">isUserVerifyingPlatformAuthenticatorAvailable</span><span style="color:#c0c5ce;">();
</span><span style="color:#c0c5ce;">
</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">hasAutofillSupport </span><span style="color:#c0c5ce;">=
</span><span style="color:#c0c5ce;">	</span><span style="color:#bf616a;">await passkeyCredential</span><span style="color:#c0c5ce;">?.</span><span style="color:#8fa1b3;">isConditionalMediationAvailable</span><span style="color:#c0c5ce;">();
</span></code></pre>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">passkeySupport </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">hasPlatformSupport </span><span style="color:#c0c5ce;">&amp;&amp; </span><span style="color:#bf616a;">hasAutofillSupport</span><span style="color:#c0c5ce;">;
</span></code></pre>
<hr />
<h3><a href="#no-platform-no-autofill-no-service" aria-hidden="true" class="anchor" id="no-platform-no-autofill-no-service"></a>No Platform, No Autofill, No Service</h3>
<p>Just Say No 🙅‍♀️</p>
<p><small>diminishing returns on stuff your mom will never know</small></p>
<hr />
<h1><a href="#process" aria-hidden="true" class="anchor" id="process"></a>Process</h1>
<ol start="0">
<li>(server) Challenge Generation</li>
<li>Credential Registration (<code>webauthn.create</code>)</li>
<li>(server) Credential Storage</li>
<li>Credential Authentication (<code>webauthn.get</code>)
<ul>
<li>(also called <code>assertion</code>)</li>
</ul>
</li>
<li>(server) Credential Verification</li>
</ol>
<hr />
<h2><a href="#2b" aria-hidden="true" class="anchor" id="2b"></a>2.b</h2>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#b48ead;">let </span><span style="color:#bf616a;">credAuthOpts </span><span style="color:#c0c5ce;">= {
</span><span style="color:#c0c5ce;">	mediation: &quot;</span><span style="color:#a3be8c;">optional</span><span style="color:#c0c5ce;">&quot;, </span><span style="color:#65737e;">// on button click
</span><span style="color:#c0c5ce;">	signal: </span><span style="color:#bf616a;">autofillCtrl</span><span style="color:#c0c5ce;">.signal,
</span><span style="color:#c0c5ce;">	publicKey: {
</span><span style="color:#c0c5ce;">		attestation: &quot;</span><span style="color:#a3be8c;">direct</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">		authenticatorSelection: {
</span><span style="color:#c0c5ce;">			residentKey: &quot;</span><span style="color:#a3be8c;">required</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">			userVerification: &quot;</span><span style="color:#a3be8c;">preferred</span><span style="color:#c0c5ce;">&quot;,
</span><span style="color:#c0c5ce;">		},
</span><span style="color:#c0c5ce;">		challenge: </span><span style="color:#bf616a;">challenge</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">		excludeCredentials: </span><span style="color:#bf616a;">credentialIds</span><span style="color:#c0c5ce;">, </span><span style="color:#65737e;">// IMPORTANT (authcs)
</span><span style="color:#c0c5ce;">		pubKeyCredParams: [
</span><span style="color:#c0c5ce;">			{ type: &quot;</span><span style="color:#a3be8c;">public-key</span><span style="color:#c0c5ce;">&quot;, alg: -</span><span style="color:#d08770;">7 </span><span style="color:#c0c5ce;">}, </span><span style="color:#65737e;">// ECDSA P-256
</span><span style="color:#c0c5ce;">		],
</span><span style="color:#c0c5ce;">		rp: </span><span style="color:#bf616a;">relyingParty</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">		timeout: </span><span style="color:#d08770;">180 </span><span style="color:#c0c5ce;">* </span><span style="color:#d08770;">1000</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">		user: {
</span><span style="color:#c0c5ce;">			name: </span><span style="color:#bf616a;">email</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">			displayName: </span><span style="color:#bf616a;">displayName</span><span style="color:#c0c5ce;">,
</span><span style="color:#c0c5ce;">			id: </span><span style="color:#bf616a;">userSecretBytes</span><span style="color:#c0c5ce;">, </span><span style="color:#65737e;">// NOT an ID
</span><span style="color:#c0c5ce;">		},
</span><span style="color:#c0c5ce;">	},
</span><span style="color:#c0c5ce;">};
</span></code></pre>
<hr />
<h2><a href="#1d-registration" aria-hidden="true" class="anchor" id="1d-registration"></a>1.d Registration</h2>
<p>References</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/create">https://developer.mozilla.org/en-US/docs/Web/API/CredentialsContainer/create</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialCreationOptions">https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialCreationOptions</a></li>
<li><a href="https://caniuse.com/mdn-api_publickeycredential">https://caniuse.com/mdn-api_publickeycredential</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialRequestOptions">https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialRequestOptions</a></li>
<li><a href="https://caniuse.com/mdn-api_credentialscontainer_create_publickey_option_extensions">https://caniuse.com/mdn-api_credentialscontainer_create_publickey_option_extensions</a></li>
</ul>
<hr />
<h1><a href="#caveats" aria-hidden="true" class="anchor" id="caveats"></a>Caveats</h1>
<hr />
<h1><a href="#context-of-passkeys" aria-hidden="true" class="anchor" id="context-of-passkeys"></a>Context of Passkeys</h1>
<ul>
<li>Stronger Authentication for You</li>
<li>More Convenient for Your Customers</li>
<li>Single Factor</li>
<li>One-to-Many</li>
<li>A Common* Subset</li>
</ul>
<p>* <small></small></p>
<hr />
<h2><a href="#act-ii-the-quagmire" aria-hidden="true" class="anchor" id="act-ii-the-quagmire"></a>Act II: The Quagmire™</h2>
<hr />
<blockquote>
<p>The subset of WebAuthn that's implemented* and works.</p>
</blockquote>
<p>*: some tedious but critical assembly required</p>
<p>also *: most of WebAuthn will <em>never</em> be implemented</p>
<!-- IKEA, but with a non-included tri-wing driver -->
<hr />
<h2><a href="#unsupportable-features" aria-hidden="true" class="anchor" id="unsupportable-features"></a>Unsupportable Features</h2>
<p>These will probably <em>never</em> be supported:</p>
<ul>
<li>passive / background / silent authentication</li>
<li>cross-origin authentication</li>
</ul>
<p><small>unlikely that <em>all</em> vendors will agree</small></p>
<hr />
<h2><a href="#good-key-types" aria-hidden="true" class="anchor" id="good-key-types"></a>Good Key Types:</h2>
<ul>
<li>✅ -7 ECDSA <code>P-256</code> (a.k.a. <code>ES256</code>, <code>prime256v1</code>)</li>
<li>⚠️ -8 EdDSA <code>ed25519</code>
(<a href="https://caniuse.com/mdn-api_subtlecrypto_sign_ed25519">caniuse</a>)</li>
</ul>
<hr />
<h2><a href="#bad-key-types" aria-hidden="true" class="anchor" id="bad-key-types"></a>Bad Key Types</h2>
<ul>
<li>❌ RSA</li>
<li>❌ ECDSA <code>P-256k</code> (a.k.a. <code>secp256k1</code>)</li>
<li>❌ the other 200+ types</li>
</ul>
<hr />
<h1><a href="#diving-deep" aria-hidden="true" class="anchor" id="diving-deep"></a>Diving Deep</h1>
<h2><a href="#0b-challenge" aria-hidden="true" class="anchor" id="0b-challenge"></a>0.b Challenge</h2>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#ebcb8b;">Bytes</span><span style="color:#c0c5ce;">.RFC_BASE64 = </span><span style="color:#d08770;">true</span><span style="color:#c0c5ce;">;
</span><span style="color:#ebcb8b;">Bytes</span><span style="color:#c0c5ce;">.URL_BASE64 = </span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">;
</span><span style="color:#c0c5ce;">
</span><span style="color:#65737e;">/**
</span><span style="color:#65737e;"> * @param {Uint8Array|ArrayBuffer?} buffer
</span><span style="color:#65737e;"> * @param {Boolean} [rfc]
</span><span style="color:#65737e;"> */
</span><span style="color:#ebcb8b;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">bufferToBase64 </span><span style="color:#c0c5ce;">= </span><span style="color:#b48ead;">function </span><span style="color:#c0c5ce;">(buffer, rfc) {
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">bytes </span><span style="color:#c0c5ce;">= new </span><span style="color:#bf616a;">Uint8Array</span><span style="color:#c0c5ce;">(buffer);
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">binstr </span><span style="color:#c0c5ce;">= </span><span style="color:#ebcb8b;">String</span><span style="color:#c0c5ce;">.fromCharCode.</span><span style="color:#8fa1b3;">apply</span><span style="color:#c0c5ce;">(</span><span style="color:#d08770;">null</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">bytes</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">rfcBase64 </span><span style="color:#c0c5ce;">= </span><span style="color:#8fa1b3;">btoa</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">binstr</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">rfc</span><span style="color:#c0c5ce;">) {
</span><span style="color:#c0c5ce;">		</span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">rfcBase64</span><span style="color:#c0c5ce;">;
</span><span style="color:#c0c5ce;">	}
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">	</span><span style="color:#bf616a;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">rfcBase64ToUrlBase64</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">rfcBase64</span><span style="color:#c0c5ce;">);
</span><span style="color:#c0c5ce;">};
</span></code></pre>
<hr />
<h2><a href="#0c-challenge" aria-hidden="true" class="anchor" id="0c-challenge"></a>0.c Challenge</h2>
<pre lang="js" style="background-color:#2b303b;"><code><span style="color:#65737e;">/**
</span><span style="color:#65737e;"> * @param {String} rfcBase64
</span><span style="color:#65737e;"> */
</span><span style="color:#ebcb8b;">Bytes</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">rfcBase64ToUrlBase64 </span><span style="color:#c0c5ce;">= </span><span style="color:#b48ead;">function </span><span style="color:#c0c5ce;">(rfcBase64) {
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">let </span><span style="color:#bf616a;">urlBase64 </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">rfcBase64</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">replace</span><span style="color:#c0c5ce;">(/</span><span style="color:#96b5b4;">=</span><span style="color:#c0c5ce;">+</span><span style="color:#b48ead;">$</span><span style="color:#c0c5ce;">/</span><span style="color:#b48ead;">g</span><span style="color:#c0c5ce;">, &quot;&quot;);
</span><span style="color:#c0c5ce;">	</span><span style="color:#bf616a;">urlBase64 </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">urlBase64</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">replace</span><span style="color:#c0c5ce;">(/</span><span style="color:#d08770;">[/]</span><span style="color:#c0c5ce;">/</span><span style="color:#b48ead;">g</span><span style="color:#c0c5ce;">, &quot;</span><span style="color:#a3be8c;">_</span><span style="color:#c0c5ce;">&quot;);
</span><span style="color:#c0c5ce;">	</span><span style="color:#bf616a;">urlBase64 </span><span style="color:#c0c5ce;">= </span><span style="color:#bf616a;">urlBase64</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">replace</span><span style="color:#c0c5ce;">(/</span><span style="color:#d08770;">[+]</span><span style="color:#c0c5ce;">/</span><span style="color:#b48ead;">g</span><span style="color:#c0c5ce;">, &quot;</span><span style="color:#a3be8c;">-</span><span style="color:#c0c5ce;">&quot;);
</span><span style="color:#c0c5ce;">
</span><span style="color:#c0c5ce;">	</span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">urlBase64</span><span style="color:#c0c5ce;">;
</span><span style="color:#c0c5ce;">};
</span></code></pre>
<hr />
<h1><a href="#whats-webauthn" aria-hidden="true" class="anchor" id="whats-webauthn"></a>What's WebAuthn?</h1>
<p>A suite of specifications and standards related to browser-based authentication.</p>
<p>FIDO rebranded.</p>
<p>(enterprise, government, <em>lots</em> of backwards compatibility)</p>
<hr />
            </article>
        </main>

        <script src='./slides.js'></script>
    </body>
</html>
